# Vulnerability Report
Reviewer 1: Marc Fieser

Reviewer 2: Ford Fowler

Date: Feb 4, 2017

Reviewing nVisium Task Manager


# Vulnerability 1: SQL Injections
Tried to go to 
```
    http://127.0.0.1:8000/taskManager/create
```
but it was not an actual route. The debug is set to True for this site so it basically shows you every route on the site.

This is how we found accsss to :
```
    http://127.0.0.1:8000/taskManager/1/upload/
```
Where their input field for a file is a text box where an attacker can attempt to add inject what ever they would like.

I have tried many of the injections that are examples in the tutorial and I really can't get any of them to return anything to me.  Not sure where the pass word or the drop table would go down. Unsure if I understand what the curs.execute does.

The apparent fix to use the ORM to create a new file object instead of curs.execute.


# Vulnerability 2: Broken Authentication

Was able to access admin profile at:
```
    http://127.0.0.1:8000/taskManager/profile/1
```
 we then changed the email address of the admin profile to our email address and went to the forgor password url:

```
    http://127.0.0.1:8000/taskManager/forgot_password
```

We were able to reset the password through the new email and get access to full admin.

This can be fixed by ensuring that only users that are logged in can update their own profiles.

# Vulnerability 3: Cross-Site Scripting

In base_backend.html where the username dropdown span, taskmanager uses 
```
    <a data-toggle="dropdown" class="dropdown-toggle" href="#">
        <span class="username"><i class="fa fa-user fa-fw"></i> {{ user.username|safe }}</span>
        <b class="caret"></b>
    </a>        
```

which allows for the adding of scripts directly from that input. To fix this you must change the above to 

```
    <a data-toggle="dropdown" class="dropdown-toggle" href="#">
        <span class="username"><i class="fa fa-user fa-fw"></i> {{ user.username }}</span>
        <b class="caret"></b>
    </a>
```

This same bug can also be found in search.html and task_details.html as well


# Vulnerability 4: Insecure DOR
in views.py there are numerous Insecure functions that do not check to see if the user is authenticated in order to make changes to the database.

profile, manage_groups, upload are a few of the functions that need to be secured.


# Vulnerability 5: Misconfig
Misconiguration has taken place on this production level code when they left the DEBUG setting in settings.py set to True.
This opens up a huge vulnerability to the site as we were easily able to view all of the routes that are apart of the site and in turn get to some places that we should not have been able to access.

To fix this, you set the DEBUG to False in settings.py


# Vulnerability 6: Exposure
The hashing algorithm MD5 is being used in the task manager app and this is an out of date hashing algorithm.

To better secure the site we should change the settings in settings.py from:
```
   PASSWORD_HASHERS = ['django.contrib.auth.hashers.MD5PasswordHasher'] 
```
to include one or more of the following:
```
   PASSWORD_HASHERS = [
    'django.contrib.auth.hashers.PBKDF2PasswordHasher',
    'django.contrib.auth.hashers.PBKDF2SHA1PasswordHasher',
    'django.contrib.auth.hashers.Argon2PasswordHasher',
    'django.contrib.auth.hashers.BCryptSHA256PasswordHasher',
    'django.contrib.auth.hashers.BCryptPasswordHasher',
] 
```
Get that from the docs.



# Vulnerability 7: Access
In the fucntion manage groups there is a check for user.is authenticated but just because the user is logged in it doesn't mean they have access to POST whatever they want. There should be an additional check for whether or not the user has access to make those changes as well.


# Vulnerability 8: CSRF
Above the functions profile_by_id, reset_password and change_password in views.py the author of the site had added @csrf_exempt tags to each of these which enabled non logged in users to with out csrf tokens to change profile and password information.

To fix this, remove them.




